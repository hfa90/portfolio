<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#E31E24">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Sistema Drogasil">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Sistema Drogasil">

    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Ãcones para diferentes dispositivos -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16x16.png">
    <link rel="shortcut icon" href="icons/favicon.ico">

    <title>Sistema CoreOne - SGAO</title>

    <!-- ADICIONE ESTE CSS NO <head> DO SEU index.html, ANTES DE </style> -->

    <style>
        /* ========== BOTÃƒO FLUTUANTE MODERNO ========== */
        .fab-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .fab-main {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-dark));
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(227, 30, 36, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            overflow: hidden;
            position: relative;
        }

        .fab-main::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.2) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .fab-main:hover::before {
            transform: translateX(100%);
        }

        .fab-main:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 12px 35px rgba(227, 30, 36, 0.6);
        }

        .fab-main:active {
            transform: scale(0.95);
        }

        .fab-main.active {
            transform: rotate(45deg);
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .fab-options {
            position: absolute;
            bottom: 80px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
            opacity: 0;
            pointer-events: none;
            transform: translateY(20px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .fab-options.show {
            opacity: 1;
            pointer-events: all;
            transform: translateY(0);
        }

        .fab-option {
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: slideInRight 0.3s ease forwards;
            opacity: 0;
            transform: translateX(50px);
        }

        .fab-option:nth-child(1) {
            animation-delay: 0.1s;
        }

        .fab-option:nth-child(2) {
            animation-delay: 0.15s;
        }

        .fab-option:nth-child(3) {
            animation-delay: 0.2s;
        }

        .fab-option:nth-child(4) {
            animation-delay: 0.25s;
        }

        @keyframes slideInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .fab-option-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .fab-option-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: scale(0);
            transition: transform 0.3s ease;
        }

        .fab-option-btn:hover::before {
            transform: scale(1);
        }

        .fab-option-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .fab-option-btn.add-single {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .fab-option-btn.add-bulk {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .fab-option-btn.add-range {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .fab-option-btn.add-auto {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .fab-option-label {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0);
            transition: all 0.3s ease;
        }

        .fab-option:hover .fab-option-label {
            transform: scale(1);
        }

        /* Overlay para fechar o menu */
        .fab-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999;
            display: none;
        }

        .fab-overlay.show {
            display: block;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .fab-container {
                bottom: 20px;
                right: 20px;
            }

            .fab-main {
                width: 55px;
                height: 55px;
                font-size: 22px;
            }

            .fab-option-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .fab-option-label {
                font-size: 13px;
                padding: 6px 12px;
            }
        }

        /* Pulso de notificaÃ§Ã£o */
        @keyframes pulse-notification {
            0% {
                box-shadow: 0 8px 25px rgba(227, 30, 36, 0.4);
            }

            50% {
                box-shadow: 0 8px 25px rgba(227, 30, 36, 0.8), 0 0 0 10px rgba(227, 30, 36, 0.2);
            }

            100% {
                box-shadow: 0 8px 25px rgba(227, 30, 36, 0.4);
            }
        }

        .fab-main.pulse {
            animation: pulse-notification 2s infinite;
        }

        /* Tooltip moderno */
        .fab-tooltip {
            position: absolute;
            top: 50%;
            right: 75px;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fab-tooltip::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            transform: translateY(-50%);
            border: 6px solid transparent;
            border-left-color: rgba(0, 0, 0, 0.9);
        }

        .fab-main:hover .fab-tooltip {
            opacity: 1;
        }

        /* ... CSS existente ... */

        /* ========== ESTILOS PARA BOTÃ•ES BLOQUEADOS ========== */
        .tab.locked {
            position: relative;
            opacity: 0.6;
            cursor: not-allowed;
        }

        .tab.locked::after {
            content: 'ðŸ”’';
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 12px;
        }

        /* Modal de autenticaÃ§Ã£o */
        .modal-senha-geral {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .modal-senha-geral.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>



    <!-- BotÃ£o Flutuante Moderno -->
    <div class="fab-overlay" id="fab-overlay" onclick="closeFabMenu()"></div>

    <div class="fab-container">
        <div class="fab-options" id="fab-options">

            <!-- OpÃ§Ã£o 1: Adicionar Coletor Individual -->
            <div class="fab-option" onclick="adicionarColetorUnico()">
                <div class="fab-option-label">Adicionar 1 Coletor</div>
                <button class="fab-option-btn add-single">
                    <span>+1</span>
                </button>
            </div>

            <!-- OpÃ§Ã£o 2: Adicionar MÃºltiplos -->
            <div class="fab-option" onclick="adicionarColetoresMultiplos()">
                <div class="fab-option-label">Adicionar VÃ¡rios</div>
                <button class="fab-option-btn add-bulk">
                    <span>+N</span>
                </button>
            </div>

            <!-- OpÃ§Ã£o 3: Adicionar em SequÃªncia -->
            <div class="fab-option" onclick="adicionarColetoresSequencia()">
                <div class="fab-option-label">SequÃªncia AutomÃ¡tica</div>
                <button class="fab-option-btn add-range">
                    <span>â†—</span>
                </button>
            </div>

            <!-- OpÃ§Ã£o 4: ConfiguraÃ§Ã£o AvanÃ§ada -->
            <div class="fab-option" onclick="configuracaoAvancada()">
                <div class="fab-option-label">Config. AvanÃ§ada</div>
                <button class="fab-option-btn add-auto">
                    <span>âš™</span>
                </button>
            </div>

        </div>

        <!-- BotÃ£o Principal -->
        <button class="fab-main" id="fab-main" onclick="toggleFabMenu()">
            <span id="fab-icon">+</span>
            <div class="fab-tooltip">Adicionar Coletores</div>
        </button>
    </div>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --drogasil-red: #E31E24;
            --drogasil-red-dark: #C11119;
            --drogasil-red-light: #FF4449;
            --drogasil-white: #FFFFFF;
            --drogasil-gray: #F5F5F5;
            --success: #00C851;
            --success-dark: #00A041;
            --warning: #FF8900;
            --text-dark: #2C3E50;
            --text-medium: #5A6C7D;
            --text-light: #8B9DC3;
            --shadow-light: 0 2px 10px rgba(227, 30, 36, 0.08);
            --shadow-medium: 0 4px 20px rgba(227, 30, 36, 0.12);
            --shadow-heavy: 0 10px 40px rgba(227, 30, 36, 0.15);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #E31E24 0%, #C11119 35%, #A00E15 100%);
            min-height: 100vh;
            color: var(--text-dark);
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 20px auto;
            background: var(--drogasil-white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
            overflow: hidden;
            position: relative;
            z-index: 1;
            animation: slideInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, var(--drogasil-red) 0%, var(--drogasil-red-dark) 100%);
            color: var(--drogasil-white);
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.05) 50%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .tabs {
            display: flex;
            background: var(--drogasil-gray);
            border-bottom: 1px solid #E0E0E0;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            flex: 1;
            min-width: 140px;
            padding: 20px 15px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: var(--transition);
            color: var(--text-medium);
            position: relative;
            white-space: nowrap;
        }

        .tab::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-light));
            transform: translateX(-50%);
            transition: var(--transition);
            border-radius: 2px 2px 0 0;
        }

        .tab.active {
            color: var(--drogasil-red);
            background: var(--drogasil-white);
            transform: translateY(-2px);
            box-shadow: 0 -5px 20px rgba(227, 30, 36, 0.15);
        }

        .tab.active::before {
            width: 80%;
        }

        .tab:hover:not(.active) {
            background: rgba(227, 30, 36, 0.05);
            transform: translateY(-1px);
            color: var(--drogasil-red);
        }

        .tab-content {
            display: none;
            padding: 40px;
            animation: fadeInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 500px;
            background: white;
            position: relative;
            z-index: 1;
        }

        .tab-content.active {
            display: block;
        }

        .colaboradores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .colaborador-card {
            background: var(--drogasil-white);
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            padding: 25px;
            transition: var(--transition);
            cursor: pointer;
            box-shadow: var(--shadow-light);
            position: relative;
            overflow: hidden;
        }

        .colaborador-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--drogasil-red);
            transition: var(--transition);
        }

        .colaborador-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
            border-color: var(--drogasil-red);
        }

        .colaborador-card h4 {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .colaborador-info {
            margin-bottom: 15px;
        }

        .colaborador-info p {
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--text-medium);
        }

        .colaborador-info strong {
            color: var(--text-dark);
            font-weight: 600;
        }

        .turno-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .turno-1 {
            background: rgba(0, 200, 81, 0.15);
            color: var(--success-dark);
            border: 1px solid rgba(0, 200, 81, 0.3);
        }

        .turno-2 {
            background: rgba(255, 137, 0, 0.15);
            color: #e68900;
            border: 1px solid rgba(255, 137, 0, 0.3);
        }

        /* Timer em tempo real */
        .timer-display {
            background: linear-gradient(135deg, #2C3E50, #34495E);
            color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-top: 15px;
            text-align: center;
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            box-shadow: var(--shadow-medium);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.9;
            }
        }

        .timer-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* HistÃ³rico */
        .historico-container {
            margin-top: 30px;
        }

        .historico-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .historico-table {
            width: 100%;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .historico-table thead {
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-dark));
            color: white;
        }

        .historico-table th,
        .historico-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #E0E0E0;
        }

        .historico-table tbody tr:hover {
            background: var(--drogasil-gray);
            transition: var(--transition);
        }

        .historico-table tbody tr:last-child td {
            border-bottom: none;
        }

        .tempo-badge {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }

        .estatisticas-card {
            background: linear-gradient(135deg, white, var(--drogasil-gray));
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            margin-bottom: 20px;
            border: 2px solid #E0E0E0;
        }

        .estatisticas-card h4 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .estat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #E0E0E0;
        }

        .estat-item:last-child {
            border-bottom: none;
        }

        .estat-value {
            font-weight: 700;
            color: var(--drogasil-red);
        }

        /* Sistema de Senha */
        .password-input-group {
            position: relative;
        }

        .password-toggle {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-medium);
            font-size: 20px;
            padding: 5px;
            transition: var(--transition);
        }

        .password-toggle:hover {
            color: var(--drogasil-red);
        }

        .password-protected {
            background: var(--drogasil-gray);
            padding: 40px;
            text-align: center;
            border-radius: var(--border-radius);
            max-width: 500px;
            margin: 40px auto;
        }

        .password-protected h3 {
            margin-bottom: 20px;
            color: var(--text-dark);
        }

        .password-protected .form-group {
            margin-bottom: 20px;
        }

        .lock-icon {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--drogasil-red);
        }

        /* Active Timer Badge */
        .active-timer {
            display: inline-block;
            background: var(--success);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: 700;
            margin-left: 10px;
            animation: blink 1s infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.6;
            }
        }

        .backup-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .backup-card {
            background: var(--drogasil-white);
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            box-shadow: var(--shadow-light);
            transition: var(--transition);
        }

        .backup-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .backup-card h3 {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .backup-card p {
            color: var(--text-medium);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .backup-info {
            background: var(--drogasil-gray);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
        }

        .backup-info h4 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #E0E0E0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: var(--text-dark);
        }

        .info-value {
            color: var(--text-medium);
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--drogasil-white) 0%, var(--drogasil-gray) 100%);
            padding: 30px 25px;
            border-radius: var(--border-radius);
            text-align: center;
            box-shadow: var(--shadow-light);
            border: 2px solid transparent;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--drogasil-red);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-card.total {
            background: linear-gradient(135deg, var(--drogasil-red) 0%, var(--drogasil-red-dark) 100%);
            color: var(--drogasil-white);
        }

        .stat-card.success {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-dark) 100%);
            color: var(--drogasil-white);
        }

        .stat-card.danger {
            background: linear-gradient(135deg, var(--drogasil-red-light) 0%, var(--drogasil-red) 100%);
            color: var(--drogasil-white);
        }

        .stat-card.warning {
            background: linear-gradient(135deg, var(--warning) 0%, #cc6f00 100%);
            color: var(--drogasil-white);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .stat-card h3 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 1rem;
            font-weight: 600;
            opacity: 0.9;
        }

        .search-filter-section {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            margin-bottom: 30px;
            padding: 25px;
            background: var(--drogasil-gray);
            border-radius: var(--border-radius);
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 15px 20px;
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition);
            background: var(--drogasil-white);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--drogasil-red);
            box-shadow: 0 0 0 3px rgba(227, 30, 36, 0.1);
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 12px 24px;
            border: 2px solid #E0E0E0;
            border-radius: 25px;
            background: var(--drogasil-white);
            color: var(--text-medium);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }

        .filter-btn.active {
            background: var(--drogasil-red);
            color: var(--drogasil-white);
            border-color: var(--drogasil-red);
        }

        .filter-btn:hover:not(.active) {
            border-color: var(--drogasil-red);
            color: var(--drogasil-red);
        }

        .collectors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }

        .collector-card {
            background: var(--drogasil-white);
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            padding: 25px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .collector-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            transition: var(--transition);
        }

        .collector-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .collector-card.disponivel {
            border-color: rgba(0, 200, 81, 0.3);
            background: linear-gradient(135deg, rgba(0, 200, 81, 0.02), rgba(0, 200, 81, 0.05));
        }

        .collector-card.disponivel::before {
            background: linear-gradient(135deg, var(--success), var(--success-dark));
        }

        .collector-card.disponivel:hover {
            border-color: var(--success);
            box-shadow: 0 10px 30px rgba(0, 200, 81, 0.2);
        }

        .collector-card.retirado {
            border-color: rgba(227, 30, 36, 0.3);
            background: linear-gradient(135deg, rgba(227, 30, 36, 0.02), rgba(227, 30, 36, 0.05));
        }

        .collector-card.retirado::before {
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-dark));
        }

        .collector-card.retirado:hover {
            border-color: var(--drogasil-red);
            box-shadow: 0 10px 30px rgba(227, 30, 36, 0.2);
        }

        .collector-card.manutencao {
            border-color: rgba(255, 137, 0, 0.3);
            background: linear-gradient(135deg, rgba(255, 137, 0, 0.02), rgba(255, 137, 0, 0.05));
        }

        .collector-card.manutencao::before {
            background: linear-gradient(135deg, var(--warning), #cc6f00);
        }

        .collector-card.manutencao:hover {
            border-color: var(--warning);
            box-shadow: 0 10px 30px rgba(255, 137, 0, 0.2);
        }

        .collector-card h4 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            gap: 8px;
            margin-bottom: 15px;
        }

        .status-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.7;
                transform: scale(1.1);
            }
        }

        .status-disponivel {
            background: rgba(0, 200, 81, 0.15);
            color: var(--success-dark);
            border: 1px solid rgba(0, 200, 81, 0.3);
        }

        .status-disponivel::before {
            background: var(--success);
        }

        .status-retirado {
            background: rgba(227, 30, 36, 0.15);
            color: var(--drogasil-red-dark);
            border: 1px solid rgba(227, 30, 36, 0.3);
        }

        .status-retirado::before {
            background: var(--drogasil-red);
        }

        .status-manutencao {
            background: rgba(255, 137, 0, 0.15);
            color: #cc6f00;
            border: 1px solid rgba(255, 137, 0, 0.3);
        }

        .status-manutencao::before {
            background: var(--warning);
        }

        .collector-info {
            margin-top: 15px;
            text-align: left;
            background: rgba(0, 0, 0, 0.02);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .collector-info p {
            margin-bottom: 5px;
            font-size: 14px;
            color: var(--text-medium);
        }

        .collector-info strong {
            color: var(--text-dark);
            font-weight: 600;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background: var(--drogasil-white);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-heavy);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideInScale 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInScale {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--drogasil-gray);
        }

        .modal-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
            padding: 8px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: var(--drogasil-red);
            background: rgba(227, 30, 36, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px 18px;
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition);
            background: var(--drogasil-white);
            font-weight: 500;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--drogasil-red);
            box-shadow: 0 0 0 3px rgba(227, 30, 36, 0.1);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            margin-right: 10px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: var(--shadow-light);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-dark));
            color: var(--drogasil-white);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), var(--success-dark));
            color: var(--drogasil-white);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 200, 81, 0.3);
        }

        .btn-secondary {
            background: #6C757D;
            color: var(--drogasil-white);
        }

        .btn-secondary:hover {
            background: #5A6268;
            transform: translateY(-2px);
        }

        .alert {
            padding: 15px 20px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            font-weight: 600;
            border-left: 4px solid;
            animation: slideInRight 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .alert-success {
            background: rgba(0, 200, 81, 0.1);
            border-left-color: var(--success);
            color: var(--success-dark);
        }

        .alert-error {
            background: rgba(227, 30, 36, 0.1);
            border-left-color: var(--drogasil-red);
            color: var(--drogasil-red-dark);
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .tab-content {
                padding: 25px 20px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .collectors-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }

            .search-filter-section {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .search-input {
                min-width: auto;
            }

            .filter-buttons {
                justify-content: center;
            }

            .modal-content {
                margin: 20px;
                padding: 30px 20px;
            }

            .historico-table {
                font-size: 12px;
            }

            .historico-table th,
            .historico-table td {
                padding: 10px 8px;
            }
        }

        /* ========== ESTILOS PARA ABA DE RELATÃ“RIOS ========== */
        .relatorio-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--drogasil-gray), white);
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
        }

        .relatorio-title {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .relatorio-subtitle {
            font-size: 1.1rem;
            color: var(--text-medium);
            margin: 0;
        }

        .controls-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--drogasil-gray);
            border-radius: var(--border-radius);
            flex-wrap: wrap;
            gap: 15px;
        }

        .controls-left {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .controls-right {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .select-styled {
            padding: 12px 18px;
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            background: white;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .select-styled:focus {
            outline: none;
            border-color: var(--drogasil-red);
        }

        .btn-refresh,
        .btn-export {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }

        .btn-refresh {
            background: var(--success);
            color: white;
        }

        .btn-refresh:hover {
            background: var(--success-dark);
            transform: translateY(-2px);
        }

        .btn-export {
            background: var(--drogasil-red);
            color: white;
        }

        .btn-export:hover {
            background: var(--drogasil-red-dark);
            transform: translateY(-2px);
        }

        .metrics-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .metric-card {
            background: white;
            padding: 30px 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: 2px solid #E0E0E0;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--drogasil-red);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .metric-card:hover::before {
            transform: scaleX(1);
        }

        .metric-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--drogasil-red);
            margin-bottom: 10px;
        }

        .metric-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .metric-change {
            font-size: 0.85rem;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 15px;
        }

        .metric-change.positive {
            background: rgba(0, 200, 81, 0.15);
            color: var(--success-dark);
        }

        .metric-change.negative {
            background: rgba(227, 30, 36, 0.15);
            color: var(--drogasil-red-dark);
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: 2px solid #E0E0E0;
            margin-bottom: 40px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-dark);
            margin: 0;
        }

        .chart-canvas {
            width: 100%;
            height: 300px;
            background: var(--drogasil-gray);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-medium);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .report-panel {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: 2px solid #E0E0E0;
            overflow: hidden;
        }

        .panel-header {
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-dark));
            color: white;
            padding: 20px 25px;
        }

        .panel-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .panel-icon {
            font-size: 1.5rem;
        }

        .ranking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            border-bottom: 1px solid #E0E0E0;
            transition: var(--transition);
        }

        .ranking-item:hover {
            background: var(--drogasil-gray);
        }

        .ranking-item:last-child {
            border-bottom: none;
        }

        .ranking-position {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--drogasil-red);
            margin-right: 15px;
        }

        .ranking-info {
            flex: 1;
        }

        .ranking-name {
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 3px;
        }

        .ranking-details {
            font-size: 0.85rem;
            color: var(--text-medium);
        }

        .ranking-value {
            font-weight: 700;
            color: var(--drogasil-red);
            font-size: 1.1rem;
        }

        .turno-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 25px;
        }

        .turno-card {
            text-align: center;
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
            transition: var(--transition);
        }

        .turno-card.turno-1 {
            background: linear-gradient(135deg, rgba(0, 200, 81, 0.05), rgba(0, 200, 81, 0.1));
            border-color: rgba(0, 200, 81, 0.3);
        }

        .turno-card.turno-2 {
            background: linear-gradient(135deg, rgba(255, 137, 0, 0.05), rgba(255, 137, 0, 0.1));
            border-color: rgba(255, 137, 0, 0.3);
        }

        .turno-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .turno-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .turno-stat {
            margin-bottom: 10px;
        }

        .turno-stat-label {
            font-size: 0.9rem;
            color: var(--text-medium);
            margin-bottom: 5px;
        }

        .turno-stat-value {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--drogasil-red);
        }

        .maintenance-panel {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: 2px solid #E0E0E0;
            margin-bottom: 40px;
            overflow: hidden;
        }

        .maintenance-header {
            background: linear-gradient(135deg, var(--warning), #cc6f00);
            color: white;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .maintenance-icon {
            font-size: 2rem;
        }

        .maintenance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid #E0E0E0;
        }

        .maintenance-item:last-child {
            border-bottom: none;
        }

        .maintenance-info {
            flex: 1;
        }

        .maintenance-coletor {
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
        }

        .maintenance-motivo {
            color: var(--text-medium);
            font-size: 0.9rem;
            margin-bottom: 3px;
        }

        .maintenance-data {
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .maintenance-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            background: rgba(255, 137, 0, 0.15);
            color: #cc6f00;
            border: 1px solid rgba(255, 137, 0, 0.3);
        }

        .insights-panel {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: 2px solid #E0E0E0;
            overflow: hidden;
        }

        .insights-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .insights-icon {
            font-size: 2rem;
        }

        .insights-title {
            font-size: 1.4rem;
            font-weight: 700;
        }

        .insight-item {
            padding: 20px 25px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .insight-item:last-child {
            border-bottom: none;
        }

        .insight-icon {
            font-size: 1.5rem;
            width: 40px;
            text-align: center;
        }

        .insight-content {
            flex: 1;
        }

        .insight-title {
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
        }

        .insight-description {
            color: var(--text-medium);
            font-size: 0.9rem;
        }

        .insight-item.success {
            background: rgba(0, 200, 81, 0.05);
            border-left: 4px solid var(--success);
        }

        .insight-item.warning {
            background: rgba(255, 137, 0, 0.05);
            border-left: 4px solid var(--warning);
        }

        .insight-item.info {
            background: rgba(52, 152, 219, 0.05);
            border-left: 4px solid #3498db;
        }

        /* ========== ESTILOS PARA ABA DE ADMINISTRAÃ‡ÃƒO ========== */
        .admin-section {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
            border: 2px solid #E0E0E0;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .admin-section-header {
            background: linear-gradient(135deg, var(--drogasil-red), var(--drogasil-red-dark));
            color: white;
            padding: 25px 30px;
        }

        .admin-section-header h3 {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .admin-section-header p {
            opacity: 0.9;
            margin: 0;
        }

        .admin-actions {
            padding: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            border-bottom: 1px solid #E0E0E0;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
        }

        .admin-stat-card {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: var(--drogasil-gray);
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
            transition: var(--transition);
        }

        .admin-stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .admin-stat-icon {
            font-size: 2rem;
            width: 50px;
            text-align: center;
        }

        .admin-stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--drogasil-red);
            margin-bottom: 5px;
        }

        .admin-stat-label {
            font-size: 0.9rem;
            color: var(--text-medium);
            font-weight: 600;
        }

        .admin-config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            padding: 30px;
        }

        .admin-config-card {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            padding: 25px;
            background: var(--drogasil-gray);
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
            transition: var(--transition);
        }

        .admin-config-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .admin-config-icon {
            font-size: 2.5rem;
            width: 60px;
            text-align: center;
            flex-shrink: 0;
        }

        .admin-config-content h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .admin-config-content p {
            color: var(--text-medium);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .admin-logs-container {
            padding: 30px;
        }

        .admin-logs-filters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .admin-logs-list {
            background: var(--drogasil-gray);
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
            max-height: 400px;
            overflow-y: auto;
        }

        .admin-log-item {
            padding: 15px 20px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .admin-log-item:hover {
            background: white;
        }

        .admin-log-item:last-child {
            border-bottom: none;
        }

        .admin-log-info {
            flex: 1;
        }

        .admin-log-action {
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
        }

        .admin-log-details {
            font-size: 0.85rem;
            color: var(--text-medium);
        }

        .admin-log-timestamp {
            font-size: 0.8rem;
            color: var(--text-light);
            font-weight: 600;
        }

        /* ========== MELHORIAS VISUAIS PROFISSIONAIS ========== */
        .password-protected {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            background: linear-gradient(135deg, var(--drogasil-gray), white);
            border-radius: var(--border-radius);
            border: 2px solid #E0E0E0;
            text-align: center;
            padding: 40px;
        }

        .lock-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.7;
        }

        .password-protected h3 {
            color: var(--text-dark);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .password-protected p {
            color: var(--text-medium);
            margin-bottom: 30px;
            max-width: 400px;
        }

        .select-styled {
            padding: 12px 15px;
            border: 2px solid #E0E0E0;
            border-radius: var(--border-radius);
            background: white;
            font-size: 14px;
            color: var(--text-dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .select-styled:focus {
            outline: none;
            border-color: var(--drogasil-red);
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .active-timer {
            background: var(--success);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }

            100% {
                opacity: 1;
            }
        }

        .colaborador-card {
            transition: var(--transition);
            cursor: pointer;
        }

        .colaborador-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .collector-card {
            transition: var(--transition);
            cursor: pointer;
        }

        .collector-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .alert {
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 15px;
            font-weight: 600;
            border: 2px solid transparent;
        }

        .alert-success {
            background: rgba(0, 200, 81, 0.1);
            color: var(--success);
            border-color: rgba(0, 200, 81, 0.3);
        }

        .alert-error {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger);
            border-color: rgba(220, 53, 69, 0.3);
        }

        .alert-warning {
            background: rgba(255, 137, 0, 0.1);
            color: var(--warning);
            border-color: rgba(255, 137, 0, 0.3);
        }

        .modal-content {
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn {
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(0);
        }

        .stat-card {
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ¥ Sistema CoreOne</h1>
            <p>Tudo que a sua operaÃ§Ã£o precisa em um sÃ³ nÃºcleo.</p>
        </div>

        <div class="tabs">
            <a href="/home" class="tab" style="text-decoration: none;">ðŸ  Home</a>
            <button class="tab active" onclick="showTab('status')">ðŸ“Š Status Geral</button>
            <button class="tab" onclick="showTab('colaboradores')">ðŸ‘¥ Colaboradores</button>
            <button class="tab locked" onclick="solicitarSenha('inventario')">ðŸ“¦ InventÃ¡rio</button>
            <button class="tab locked" onclick="solicitarSenha('relatorios')">ðŸ“Š RelatÃ³rios</button>
            <button class="tab locked" onclick="solicitarSenha('backup')">ðŸ’¾ Backup</button>
            <a href="/login" class="tab" style="text-decoration: none;">ðŸšª Sair</a>
        </div>

        <!-- STATUS TAB -->
        <div id="status" class="tab-content active">
            <h2 class="section-title">ðŸ“Š Status em Tempo Real dos Coletores</h2>

            <div class="stats-grid">
                <div class="stat-card total">
                    <h3 id="total-coletores">58</h3>
                    <p>Total de Coletores</p>
                </div>
                <div class="stat-card success">
                    <h3 id="coletores-disponiveis">58</h3>
                    <p>DisponÃ­veis</p>
                </div>
                <div class="stat-card danger">
                    <h3 id="coletores-retirados">0</h3>
                    <p>Em Uso</p>
                </div>
                <div class="stat-card warning">
                    <h3 id="coletores-manutencao">0</h3>
                    <p>Em ManutenÃ§Ã£o</p>
                </div>
            </div>

            <div class="search-filter-section">
                <input type="text" id="search-input" class="search-input"
                    placeholder="ðŸ” Pesquisar coletor por nÃºmero..." oninput="filtrarColetores()">

                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filtrarStatus('todos')">Todos</button>
                    <button class="filter-btn" onclick="filtrarStatus('disponivel')">DisponÃ­veis</button>
                    <button class="filter-btn" onclick="filtrarStatus('retirado')">Em Uso</button>
                    <button class="filter-btn" onclick="filtrarStatus('manutencao')">Em ManutenÃ§Ã£o</button>
                </div>
            </div>

            <div class="collectors-grid" id="collectors-grid">
                <!-- Coletores serÃ£o gerados dinamicamente -->
            </div>
        </div>

        <!-- COLABORADORES TAB -->
        <div id="colaboradores" class="tab-content">
            <h2 class="section-title">ðŸ‘¥ Cadastro de Colaboradores</h2>

            <div class="search-filter-section">
                <input type="text" id="search-colaboradores" class="search-input"
                    placeholder="ðŸ” Pesquisar colaborador por nome ou matrÃ­cula..." oninput="filtrarColaboradores()">
                <button class="btn btn-primary" onclick="abrirModalNovoColaboradorComSenha()">
                    âž• Novo Colaborador
                </button>
            </div>

            <div class="stats-grid">
                <div class="stat-card total">
                    <h3 id="total-colaboradores">0</h3>
                    <p>Total de Colaboradores</p>
                </div>
                <div class="stat-card success">
                    <h3 id="colaboradores-turno1">0</h3>
                    <p>1Âº Turno</p>
                </div>
                <div class="stat-card danger">
                    <h3 id="colaboradores-turno2">0</h3>
                    <p>2Âº Turno</p>
                </div>
            </div>

            <div class="colaboradores-grid" id="colaboradores-grid">
                <!-- Colaboradores serÃ£o gerados dinamicamente -->
            </div>
        </div>

        <!-- HISTÃ“RICO TAB -->
        <div id="historico" class="tab-content">
            <div id="historico-content" style="display: none;">
                <h2 class="section-title">ðŸ“ˆ HistÃ³rico Completo de MovimentaÃ§Ãµes</h2>

                <div class="historico-filters">
                    <input type="date" id="filter-data-inicio" class="search-input" style="flex: 0 1 200px;">
                    <input type="date" id="filter-data-fim" class="search-input" style="flex: 0 1 200px;">
                    <input type="text" id="filter-colaborador" class="search-input"
                        placeholder="Filtrar por colaborador..." style="flex: 1;">
                    <button class="btn btn-primary" onclick="filtrarHistorico()">ðŸ” Filtrar</button>
                    <button class="btn btn-secondary" onclick="limparFiltrosHistorico()">Limpar</button>
                </div>

                <div class="estatisticas-card">
                    <h4>ðŸ“Š EstatÃ­sticas do PerÃ­odo</h4>
                    <div class="estat-item">
                        <span>Total de Retiradas:</span>
                        <span class="estat-value" id="estat-total-retiradas">0</span>
                    </div>
                    <div class="estat-item">
                        <span>Tempo MÃ©dio de Uso:</span>
                        <span class="estat-value" id="estat-tempo-medio">0h 0min</span>
                    </div>
                    <div class="estat-item">
                        <span>Colaborador Mais Ativo:</span>
                        <span class="estat-value" id="estat-mais-ativo">-</span>
                    </div>
                    <div class="estat-item">
                        <span>Coletor Mais Utilizado:</span>
                        <span class="estat-value" id="estat-coletor-mais-usado">-</span>
                    </div>
                </div>

                <div class="historico-container">
                    <table class="historico-table">
                        <thead>
                            <tr>
                                <th>Coletor</th>
                                <th>Colaborador</th>
                                <th>MatrÃ­cula</th>
                                <th>Turno</th>
                                <th>Retirada</th>
                                <th>DevoluÃ§Ã£o</th>
                                <th>Tempo de Uso</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="historico-tbody">
                            <!-- HistÃ³rico serÃ¡ gerado dinamicamente -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="historico-senha" class="password-protected">
                <div class="lock-icon">ðŸ”’</div>
                <h3>Ãrea Protegida por Senha</h3>
                <p>Digite a senha para acessar o histÃ³rico completo</p>
                <div class="form-group">
                    <div class="password-input-group">
                        <input type="password" id="senha-historico" placeholder="Digite a senha..."
                            onkeypress="if(event.key==='Enter') verificarSenhaHistorico()">
                        <button class="password-toggle" onclick="togglePassword('senha-historico')">ðŸ‘ï¸</button>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="verificarSenhaHistorico()">ðŸ”“ Acessar HistÃ³rico</button>
                <div id="alert-senha-historico"></div>
            </div>
        </div>

        <!-- BACKUP TAB -->
        <div id="backup" class="tab-content">
            <h2 class="section-title">ðŸ’¾ Backup e RecuperaÃ§Ã£o de Dados</h2>

            <div class="backup-section">
                <div class="backup-card">
                    <h3>ðŸ“¤ Fazer Backup</h3>
                    <p>Salve todos os dados do sistema (colaboradores, coletores e histÃ³rico) em um arquivo.</p>
                    <button class="btn btn-primary" onclick="fazerBackup()">
                        ðŸ’¾ Fazer Backup Completo
                    </button>
                </div>

                <div class="backup-card">
                    <h3>ðŸ“¥ Restaurar Backup</h3>
                    <p>Carregue dados de um arquivo de backup anterior.</p>
                    <input type="file" id="arquivo-backup" accept=".json" style="display: none;"
                        onchange="restaurarBackup(event)">
                    <button class="btn btn-success" onclick="document.getElementById('arquivo-backup').click()">
                        ðŸ“‚ Carregar Backup
                    </button>
                </div>

                <div class="backup-card">
                    <h3>ðŸ—‘ï¸ Limpar Dados</h3>
                    <p>Remove todos os dados salvos no sistema (aÃ§Ã£o irreversÃ­vel).</p>
                    <button class="btn" style="background: #dc3545; color: white;" onclick="confirmarLimpeza()">
                        ðŸ—‘ï¸ Limpar Todos os Dados
                    </button>
                </div>
            </div>

            <div class="backup-info">
                <h4>â„¹ï¸ InformaÃ§Ãµes do Sistema</h4>
                <div id="info-sistema">
                    <!-- InformaÃ§Ãµes serÃ£o preenchidas dinamicamente -->
                </div>
            </div>

            <!-- HTML DA ABA RELATÃ“RIOS REDESENHADA -->
            <div id="relatorios" class="tab-content">
                <!-- Header Principal -->
                <div class="relatorio-header">
                    <h2 class="relatorio-title">
                        <span>ðŸ“Š</span>
                        Central de RelatÃ³rios e Analytics
                    </h2>
                    <p class="relatorio-subtitle">
                        AnÃ¡lises avanÃ§adas e insights em tempo real do sistema de coletores
                    </p>
                </div>

                <!-- Barra de Controles -->
                <div class="controls-bar">
                    <div class="controls-left">
                        <select id="relatorio-periodo" class="select-styled" onchange="gerarRelatorio()">
                            <option value="hoje">ðŸ“… Hoje</option>
                            <option value="semana" selected>ðŸ“† Esta Semana</option>
                            <option value="mes">ðŸ—“ï¸ Este MÃªs</option>
                            <option value="trimestre">ðŸ“‹ Ãšltimo Trimestre</option>
                            <option value="todos">ðŸ”„ Todos os PerÃ­odos</option>
                        </select>
                        <span style="color: var(--text-medium); font-size: 14px;" id="ultima-atualizacao">
                            Atualizado agora
                        </span>
                    </div>
                    <div class="controls-right">
                        <button class="btn-refresh" onclick="gerarRelatorio()">
                            <span>ðŸ”„</span>
                            Atualizar
                        </button>
                        <button class="btn-export" onclick="exportarRelatorio()">
                            <span>ðŸ“Š</span>
                            Exportar PDF
                        </button>
                    </div>
                </div>

                <!-- Dashboard de MÃ©tricas -->
                <div class="metrics-dashboard">
                    <div class="metric-card">
                        <div class="metric-icon">ðŸ“ˆ</div>
                        <div class="metric-value" id="relatorio-total-movimentacoes">0</div>
                        <div class="metric-label">Total de MovimentaÃ§Ãµes</div>
                        <div class="metric-change positive" id="change-movimentacoes">+0% vs perÃ­odo anterior</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon">â±ï¸</div>
                        <div class="metric-value" id="relatorio-tempo-medio">0h 0m</div>
                        <div class="metric-label">Tempo MÃ©dio de Uso</div>
                        <div class="metric-change positive" id="change-tempo">Otimizado</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon">ðŸ”§</div>
                        <div class="metric-value" id="relatorio-coletores-manutencao">0</div>
                        <div class="metric-label">Em ManutenÃ§Ã£o</div>
                        <div class="metric-change negative" id="change-manutencao">Requer atenÃ§Ã£o</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-icon">âš¡</div>
                        <div class="metric-value" id="relatorio-tempo-maximo">0h 0m</div>
                        <div class="metric-label">Maior Tempo Registrado</div>
                        <div class="metric-change positive" id="change-maximo">Pico de eficiÃªncia</div>
                    </div>
                </div>

                <!-- GrÃ¡fico de UtilizaÃ§Ã£o -->
                <div class="chart-container">
                    <div class="chart-header">
                        <h3 class="chart-title">ðŸ“Š GrÃ¡fico de UtilizaÃ§Ã£o Temporal</h3>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <span style="color: var(--text-medium); font-size: 14px;">Ãšltimos 7 dias</span>
                            <div
                                style="width: 12px; height: 12px; background: var(--drogasil-red); border-radius: 2px;">
                            </div>
                        </div>
                    </div>
                    <canvas id="grafico-utilizacao" class="chart-canvas"></canvas>
                </div>

                <!-- PainÃ©is de RelatÃ³rios -->
                <div class="reports-grid">
                    <!-- Ranking de Colaboradores -->
                    <div class="report-panel">
                        <div class="panel-header">
                            <h3 class="panel-title">
                                <div class="panel-icon">ðŸ†</div>
                                Top Colaboradores
                            </h3>
                        </div>
                        <div id="ranking-colaboradores">
                            <!-- SerÃ¡ preenchido dinamicamente -->
                        </div>
                    </div>

                    <!-- Ranking de Coletores -->
                    <div class="report-panel">
                        <div class="panel-header">
                            <h3 class="panel-title">
                                <div class="panel-icon">ðŸ“±</div>
                                Top Coletores
                            </h3>
                        </div>
                        <div id="ranking-coletores">
                            <!-- SerÃ¡ preenchido dinamicamente -->
                        </div>
                    </div>
                </div>

                <!-- AnÃ¡lise por Turnos -->
                <div class="report-panel" style="margin-bottom: 30px;">
                    <div class="panel-header">
                        <h3 class="panel-title">
                            <div class="panel-icon">â°</div>
                            AnÃ¡lise Comparativa por Turnos
                        </h3>
                    </div>
                    <div id="analise-turnos">
                        <!-- SerÃ¡ preenchido dinamicamente -->
                    </div>
                </div>

                <!-- Painel de ManutenÃ§Ãµes -->
                <div class="maintenance-panel">
                    <div class="maintenance-header">
                        <div class="maintenance-icon">ðŸ”§</div>
                        <div>
                            <h3 style="font-size: 1.4rem; font-weight: 700; color: #e65100; margin-bottom: 5px;">
                                Status de ManutenÃ§Ãµes
                            </h3>
                            <p style="color: #bf360c; margin: 0;">Monitoramento completo dos coletores em manutenÃ§Ã£o</p>
                        </div>
                    </div>
                    <div id="relatorio-manutencoes">
                        <!-- SerÃ¡ preenchido dinamicamente -->
                    </div>
                </div>

                <!-- Insights e Alertas -->
                <div class="insights-panel">
                    <div class="insights-header">
                        <div class="insights-icon">ðŸ’¡</div>
                        <div class="insights-title">Insights Inteligentes do Sistema</div>
                    </div>
                    <div id="alertas-sistema">
                        <!-- SerÃ¡ preenchido dinamicamente -->
                    </div>
                </div>
            </div>

            <!-- ADMINISTRAÃ‡ÃƒO TAB -->
            <div id="administracao" class="tab-content">
                <div id="administracao-content" style="display: none;">
                    <h2 class="section-title">âš™ï¸ Painel de AdministraÃ§Ã£o do Sistema</h2>

                    <!-- SeÃ§Ã£o de GestÃ£o de Coletores -->
                    <div class="admin-section">
                        <div class="admin-section-header">
                            <h3>ðŸ“± GestÃ£o de Coletores</h3>
                            <p>Adicione, edite ou remova coletores do sistema</p>
                        </div>

                        <div class="admin-actions">
                            <button class="btn btn-primary" onclick="abrirModalNovoColetorAdmin()">
                                âž• Adicionar Novo Coletor
                            </button>
                            <button class="btn btn-secondary" onclick="abrirModalEditarColetorAdmin()">
                                âœï¸ Editar Coletor Existente
                            </button>
                            <button class="btn" style="background: #dc3545; color: white;"
                                onclick="abrirModalRemoverColetorAdmin()">
                                ðŸ—‘ï¸ Remover Coletor
                            </button>
                        </div>

                        <div class="admin-stats">
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon">ðŸ“Š</div>
                                <div class="admin-stat-info">
                                    <div class="admin-stat-value" id="admin-total-coletores">58</div>
                                    <div class="admin-stat-label">Total de Coletores</div>
                                </div>
                            </div>
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon">âœ…</div>
                                <div class="admin-stat-info">
                                    <div class="admin-stat-value" id="admin-coletores-disponiveis">58</div>
                                    <div class="admin-stat-label">DisponÃ­veis</div>
                                </div>
                            </div>
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon">ðŸ”§</div>
                                <div class="admin-stat-info">
                                    <div class="admin-stat-value" id="admin-coletores-manutencao">0</div>
                                    <div class="admin-stat-label">Em ManutenÃ§Ã£o</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SeÃ§Ã£o de ConfiguraÃ§Ãµes do Sistema -->
                    <div class="admin-section">
                        <div class="admin-section-header">
                            <h3>ðŸ”§ ConfiguraÃ§Ãµes do Sistema</h3>
                            <p>Gerencie configuraÃ§Ãµes globais e seguranÃ§a</p>
                        </div>

                        <div class="admin-config-grid">
                            <div class="admin-config-card">
                                <div class="admin-config-icon">ðŸ”</div>
                                <div class="admin-config-content">
                                    <h4>Alterar Senha Administrativa</h4>
                                    <p>Modifique a senha de acesso Ã  Ã¡rea administrativa</p>
                                    <button class="btn btn-primary" onclick="abrirModalAlterarSenha()">
                                        ðŸ”‘ Alterar Senha
                                    </button>
                                </div>
                            </div>

                            <div class="admin-config-card">
                                <div class="admin-config-icon">ðŸ“Š</div>
                                <div class="admin-config-content">
                                    <h4>Exportar Dados Completos</h4>
                                    <p>FaÃ§a backup completo de todos os dados do sistema</p>
                                    <button class="btn btn-success" onclick="exportarDadosCompletos()">
                                        ðŸ’¾ Exportar Tudo
                                    </button>
                                </div>
                            </div>

                            <div class="admin-config-card">
                                <div class="admin-config-icon">ðŸ”„</div>
                                <div class="admin-config-content">
                                    <h4>Reinicializar Sistema</h4>
                                    <p>Restaure o sistema para o estado inicial</p>
                                    <button class="btn" style="background: #ff6b35; color: white;"
                                        onclick="reinicializarSistema()">
                                        ðŸ”„ Reinicializar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SeÃ§Ã£o de Logs e Auditoria -->
                    <div class="admin-section">
                        <div class="admin-section-header">
                            <h3>ðŸ“‹ Logs e Auditoria</h3>
                            <p>Visualize aÃ§Ãµes administrativas e eventos do sistema</p>
                        </div>

                        <div class="admin-logs-container">
                            <div class="admin-logs-filters">
                                <select id="admin-log-filter" class="select-styled">
                                    <option value="todos">Todos os Logs</option>
                                    <option value="coletores">GestÃ£o de Coletores</option>
                                    <option value="configuracoes">ConfiguraÃ§Ãµes</option>
                                    <option value="sistema">Sistema</option>
                                </select>
                                <button class="btn btn-secondary" onclick="limparLogsAdmin()">
                                    ðŸ—‘ï¸ Limpar Logs
                                </button>
                            </div>

                            <div class="admin-logs-list" id="admin-logs-list">
                                <!-- Logs serÃ£o preenchidos dinamicamente -->
                            </div>
                        </div>
                    </div>
                </div>

                <div id="administracao-senha" class="password-protected">
                    <div class="lock-icon">ðŸ”’</div>
                    <h3>Ãrea Administrativa Protegida</h3>
                    <p>Digite a senha de administrador para acessar o painel de controle</p>
                    <div class="form-group">
                        <div class="password-input-group">
                            <input type="password" id="senha-administracao"
                                placeholder="Digite a senha administrativa..."
                                onkeypress="if(event.key==='Enter') verificarSenhaAdministracao()">
                            <button class="password-toggle" onclick="togglePassword('senha-administracao')">ðŸ‘ï¸</button>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="verificarSenhaAdministracao()">ðŸ”“ Acessar
                        AdministraÃ§Ã£o</button>
                    <div id="alert-senha-administracao"></div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal para Senha (Novo Colaborador) -->
    <div id="modal-senha-colaborador" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ” AutenticaÃ§Ã£o NecessÃ¡ria</h3>
                <button class="close-btn" onclick="fecharModal('modal-senha-colaborador')">&times;</button>
            </div>
            <p style="margin-bottom: 20px; color: var(--text-medium);">Digite a senha de administrador para cadastrar um
                novo colaborador</p>
            <div class="form-group">
                <div class="password-input-group">
                    <input type="password" id="senha-novo-colaborador" placeholder="Digite a senha..."
                        onkeypress="if(event.key==='Enter') verificarSenhaCadastro()">
                    <button class="password-toggle" onclick="togglePassword('senha-novo-colaborador')">ðŸ‘ï¸</button>
                </div>
            </div>
            <button class="btn btn-primary" onclick="verificarSenhaCadastro()">
                ðŸ”“ Confirmar Senha
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-senha-colaborador')">
                Cancelar
            </button>
            <div id="alert-senha-colaborador"></div>
        </div>
    </div>

    <!-- Modal para Novo Colaborador -->
    <div id="modal-novo-colaborador" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ‘¥ Cadastrar Novo Colaborador</h3>
                <button class="close-btn" onclick="fecharModal('modal-novo-colaborador')">&times;</button>
            </div>
            <div class="form-group">
                <label for="novo-nome">Nome Completo</label>
                <input type="text" id="novo-nome" placeholder="Digite o nome completo" required>
            </div>
            <div class="form-group">
                <label for="nova-matricula">MatrÃ­cula</label>
                <input type="text" id="nova-matricula" placeholder="Digite a matrÃ­cula" required>
            </div>
            <div class="form-group">
                <label for="novo-turno">Turno de Trabalho</label>
                <select id="novo-turno" required>
                    <option value="">Selecione o turno</option>
                    <option value="1Âº Turno">1Âº Turno</option>
                    <option value="2Âº Turno">2Âº Turno</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="cadastrarColaborador()">
                âœ… Cadastrar Colaborador
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-novo-colaborador')">
                Cancelar
            </button>
            <div id="alert-novo-colaborador"></div>
        </div>
    </div>

    <!-- Modal para Editar Colaborador -->
    <div id="modal-editar-colaborador" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âœï¸ Editar Colaborador</h3>
                <button class="close-btn" onclick="fecharModal('modal-editar-colaborador')">&times;</button>
            </div>
            <input type="hidden" id="edit-matricula-original">
            <div class="form-group">
                <label for="edit-nome">Nome Completo</label>
                <input type="text" id="edit-nome" placeholder="Digite o nome completo" required>
            </div>
            <div class="form-group">
                <label for="edit-matricula">MatrÃ­cula</label>
                <input type="text" id="edit-matricula" placeholder="Digite a matrÃ­cula" required>
            </div>
            <div class="form-group">
                <label for="edit-turno">Turno de Trabalho</label>
                <select id="edit-turno" required>
                    <option value="">Selecione o turno</option>
                    <option value="1Âº Turno">1Âº Turno</option>
                    <option value="2Âº Turno">2Âº Turno</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="salvarEdicaoColaborador()">
                âœ… Salvar AlteraÃ§Ãµes
            </button>
            <button class="btn" style="background: #dc3545; color: white;" onclick="excluirColaborador()">
                ðŸ—‘ï¸ Excluir Colaborador
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-editar-colaborador')">
                Cancelar
            </button>
            <div id="alert-editar-colaborador"></div>
        </div>
    </div>

    <!-- Modal para Retirada de Coletor -->
    <div id="modal-retirada" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ“¤ Retirar Coletor</h3>
                <button class="close-btn" onclick="fecharModal('modal-retirada')">&times;</button>
            </div>
            <div class="form-group">
                <label>Coletor Selecionado</label>
                <input type="text" id="coletor-selecionado" readonly style="background: #f5f5f5;">
            </div>
            <div class="form-group">
                <label for="matricula-retirada">MatrÃ­cula do Colaborador</label>
                <input type="text" id="matricula-retirada" placeholder="Digite a matrÃ­cula" required
                    oninput="buscarColaboradorPorMatricula(this.value)">
            </div>
            <div class="form-group">
                <label for="nome-colaborador-display">Nome do Colaborador</label>
                <input type="text" id="nome-colaborador-display" placeholder="SerÃ¡ preenchido automaticamente" readonly
                    style="background: #f5f5f5;">
            </div>
            <div class="form-group">
                <label for="turno-display">Turno de Trabalho</label>
                <input type="text" id="turno-display" placeholder="SerÃ¡ preenchido automaticamente" readonly
                    style="background: #f5f5f5;">
            </div>
            <button class="btn btn-primary" onclick="confirmarRetirada()">
                ðŸ“¤ Confirmar Retirada
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-retirada')">
                Cancelar
            </button>
            <div id="alert-retirada"></div>
        </div>
    </div>

    <!-- Modal para DevoluÃ§Ã£o de Coletor -->
    <div id="modal-devolucao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ“¥ Devolver Coletor</h3>
                <button class="close-btn" onclick="fecharModal('modal-devolucao')">&times;</button>
            </div>
            <div class="form-group">
                <label>Coletor para DevoluÃ§Ã£o</label>
                <input type="text" id="coletor-devolucao" readonly style="background: #f5f5f5;">
            </div>
            <div id="info-colaborador"
                style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <!-- InformaÃ§Ãµes do colaborador serÃ£o mostradas aqui -->
            </div>

            <!-- Timer Display -->
            <div class="timer-display" id="timer-devolucao">
                <div class="timer-label">â±ï¸ Tempo de Uso</div>
                <div id="tempo-uso-display">00:00:00</div>
            </div>

            <button class="btn btn-success" onclick="confirmarDevolucao()">
                ðŸ“¥ Confirmar DevoluÃ§Ã£o
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-devolucao')">
                Cancelar
            </button>
            <div id="alert-devolucao"></div>
        </div>
    </div>

    <!-- Modal para ManutenÃ§Ã£o -->
    <div id="modal-manutencao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ”§ Gerenciar ManutenÃ§Ã£o</h3>
                <button class="close-btn" onclick="fecharModal('modal-manutencao')">&times;</button>
            </div>
            <div class="form-group">
                <label>Coletor Selecionado</label>
                <input type="text" id="coletor-manutencao" readonly style="background: #f5f5f5;">
            </div>
            <div id="info-manutencao"
                style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ffc107;">
                <!-- InformaÃ§Ãµes serÃ£o mostradas aqui -->
            </div>
            <div class="form-group" id="motivo-group">
                <label for="motivo-manutencao">Motivo da ManutenÃ§Ã£o</label>
                <textarea id="motivo-manutencao" rows="3"
                    style="width: 100%; padding: 12px; border: 2px solid #E0E0E0; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
            </div>
            <button class="btn" id="btn-enviar-manutencao" style="background: var(--warning); color: white;"
                onclick="enviarParaManutencao()">
                ðŸ”§ Enviar para ManutenÃ§Ã£o
            </button>
            <button class="btn btn-success" id="btn-retirar-manutencao" style="display: none;"
                onclick="retirarDeManutencao()">
                âœ… Retirar da ManutenÃ§Ã£o
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-manutencao')">
                Cancelar
            </button>
            <div id="alert-manutencao"></div>
        </div>
    </div>

    <!-- Modais para AdministraÃ§Ã£o -->
    <!-- Modal para Adicionar Novo Coletor -->
    <div id="modal-novo-coletor-admin" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âž• Adicionar Novo Coletor</h3>
                <button class="close-btn" onclick="fecharModal('modal-novo-coletor-admin')">&times;</button>
            </div>
            <div class="form-group">
                <label for="admin-novo-numero">NÃºmero do Coletor</label>
                <input type="number" id="admin-novo-numero" placeholder="Digite o nÃºmero do coletor" required min="1">
            </div>
            <div class="form-group">
                <label for="admin-novo-status">Status Inicial</label>
                <select id="admin-novo-status" required>
                    <option value="">Selecione o status inicial</option>
                    <option value="disponivel">DisponÃ­vel</option>
                    <option value="manutencao">Em ManutenÃ§Ã£o</option>
                </select>
            </div>

            <div class="form-group">
                <label for="admin-novo-observacoes">ObservaÃ§Ãµes (Opcional)</label>
                <textarea id="admin-novo-observacoes" rows="3" placeholder="Modelo, data de aquisiÃ§Ã£o, etc..."
                    style="width: 100%; padding: 12px; border: 2px solid #E0E0E0; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
            </div>
            <button class="btn btn-primary" onclick="adicionarNovoColetorAdmin()">
                âœ… Adicionar Coletor
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-novo-coletor-admin')">
                Cancelar
            </button>
            <div id="alert-novo-coletor-admin"></div>
        </div>
    </div>

    <!-- Modal para Editar Coletor -->
    <div id="modal-editar-coletor-admin" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">âœï¸ Editar Coletor</h3>
                <button class="close-btn" onclick="fecharModal('modal-editar-coletor-admin')">&times;</button>
            </div>
            <div class="form-group">
                <label for="admin-selecionar-coletor">Selecionar Coletor</label>
                <select id="admin-selecionar-coletor" onchange="carregarDadosColetorAdmin()" required>
                    <option value="">Escolha um coletor para editar</option>
                    <!-- OpÃ§Ãµes serÃ£o preenchidas dinamicamente -->
                </select>
            </div>
            <div id="admin-dados-coletor" style="display: none;">
                <div class="form-group">
                    <label for="admin-edit-numero">NÃºmero do Coletor</label>
                    <input type="number" id="admin-edit-numero" readonly style="background: #f5f5f5;">
                </div>
                <div class="form-group">
                    <label for="admin-edit-status">Status</label>
                    <select id="admin-edit-status" required>
                        <option value="disponivel">DisponÃ­vel</option>
                        <option value="manutencao">Em ManutenÃ§Ã£o</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="admin-edit-observacoes">ObservaÃ§Ãµes</label>
                    <textarea id="admin-edit-observacoes" rows="3"
                        style="width: 100%; padding: 12px; border: 2px solid #E0E0E0; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
                </div>
                <button class="btn btn-primary" onclick="salvarEdicaoColetorAdmin()">
                    âœ… Salvar AlteraÃ§Ãµes
                </button>
            </div>
            <button class="btn btn-secondary" onclick="fecharModal('modal-editar-coletor-admin')">
                Cancelar
            </button>
            <div id="alert-editar-coletor-admin"></div>
        </div>
    </div>

    <!-- Modal para Remover Coletor -->
    <div id="modal-remover-coletor-admin" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ—‘ï¸ Remover Coletor</h3>
                <button class="close-btn" onclick="fecharModal('modal-remover-coletor-admin')">&times;</button>
            </div>
            <div class="form-group">
                <label for="admin-remover-coletor">Selecionar Coletor para Remover</label>
                <select id="admin-remover-coletor" onchange="mostrarInfoColetorRemocao()" required>
                    <option value="">Escolha um coletor para remover</option>
                    <!-- OpÃ§Ãµes serÃ£o preenchidas dinamicamente -->
                </select>
            </div>
            <div id="admin-info-remocao"
                style="display: none; background: #f8d7da; padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #f5c6cb;">
                <!-- InformaÃ§Ãµes do coletor serÃ£o mostradas aqui -->
            </div>
            <div
                style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #ffc107;">
                <strong>âš ï¸ AtenÃ§Ã£o:</strong> Esta aÃ§Ã£o Ã© irreversÃ­vel. O coletor serÃ¡ removido permanentemente do
                sistema.
            </div>
            <button class="btn" style="background: #dc3545; color: white;" onclick="confirmarRemocaoColetorAdmin()">
                ðŸ—‘ï¸ Confirmar RemoÃ§Ã£o
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-remover-coletor-admin')">
                Cancelar
            </button>
            <div id="alert-remover-coletor-admin"></div>
        </div>
    </div>

    <!-- Modal para Alterar Senha -->
    <div id="modal-alterar-senha-admin" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ”‘ Alterar Senha Administrativa</h3>
                <button class="close-btn" onclick="fecharModal('modal-alterar-senha-admin')">&times;</button>
            </div>
            <div class="form-group">
                <label for="admin-senha-atual">Senha Atual</label>
                <div class="password-input-group">
                    <input type="password" id="admin-senha-atual" placeholder="Digite a senha atual" required>
                    <button class="password-toggle" onclick="togglePassword('admin-senha-atual')">ðŸ‘ï¸</button>
                </div>
            </div>
            <div class="form-group">
                <label for="admin-senha-nova">Nova Senha</label>
                <div class="password-input-group">
                    <input type="password" id="admin-senha-nova" placeholder="Digite a nova senha" required>
                    <button class="password-toggle" onclick="togglePassword('admin-senha-nova')">ðŸ‘ï¸</button>
                </div>
            </div>
            <div class="form-group">
                <label for="admin-senha-confirmar">Confirmar Nova Senha</label>
                <div class="password-input-group">
                    <input type="password" id="admin-senha-confirmar" placeholder="Confirme a nova senha" required>
                    <button class="password-toggle" onclick="togglePassword('admin-senha-confirmar')">ðŸ‘ï¸</button>
                </div>
            </div>
            <button class="btn btn-primary" onclick="alterarSenhaAdmin()">
                ðŸ”‘ Alterar Senha
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-alterar-senha-admin')">
                Cancelar
            </button>
            <div id="alert-alterar-senha-admin"></div>
        </div>
    </div>


    <!-- Modal para AutenticaÃ§Ã£o Geral -->
    <div id="modal-senha-geral" class="modal modal-senha-geral">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ðŸ” AutenticaÃ§Ã£o NecessÃ¡ria</h3>
                <button class="close-btn" onclick="fecharModal('modal-senha-geral')">&times;</button>
            </div>
            <p style="margin-bottom: 20px; color: var(--text-medium);" id="modal-senha-descricao">
                Digite a senha para acessar esta funcionalidade
            </p>
            <div class="form-group">
                <div class="password-input-group">
                    <input type="password" id="senha-geral" placeholder="Digite a senha..."
                        onkeypress="if(event.key==='Enter') verificarSenhaGeral()">
                    <button class="password-toggle" onclick="togglePassword('senha-geral')">ðŸ‘ï¸</button>
                </div>
            </div>
            <button class="btn btn-primary" onclick="verificarSenhaGeral()">
                ðŸ”“ Acessar
            </button>
            <button class="btn btn-secondary" onclick="fecharModal('modal-senha-geral')">
                Cancelar
            </button>
            <div id="alert-senha-geral"></div>
        </div>
    </div>

    <script>

        // ========== VARIÃVEIS GLOBAIS ==========
        const coletores = {};
        const colaboradores = {};
        const historico = [];
        const timers = {}; // Apenas para animaÃ§Ã£o visual local
        let filtroAtual = 'todos';
        let colaboradorSelecionado = null;
        let historicoAutenticado = false;
        let administracaoAutenticada = false;

        // ConfiguraÃ§Ãµes do sistema
        const configuracoes = {
            senhaAdmin: 'Admin@2025',
            versaoSistema: '2.0 DB Connected'
        };

        // ========== COMUNICAÃ‡ÃƒO COM O BANCO DE DADOS (API) ==========

        // FunÃ§Ã£o principal para carregar tudo do servidor
        async function carregarDadosDoServidor() {
            try {
                // 1. Carregar Coletores
                const resColetores = await fetch('/api/sgao/coletores');
                const dataColetores = await resColetores.json();

                if (dataColetores.success) {
                    // Limpar e atualizar objeto local
                    Object.keys(coletores).forEach(key => delete coletores[key]);
                    Object.assign(coletores, dataColetores.coletores);

                    // Sincronizar timers visuais
                    Object.values(coletores).forEach(c => {
                        if (c.status === 'retirado' && !timers[c.numero]) {
                            iniciarTimerVisual(c.numero);
                        } else if (c.status !== 'retirado' && timers[c.numero]) {
                            clearInterval(timers[c.numero].interval);
                            delete timers[c.numero];
                        }
                    });
                }

                // 2. Carregar Colaboradores
                const resColab = await fetch('/api/usuarios/lista');
                const dataColab = await resColab.json();

                if (dataColab.success) {
                    Object.keys(colaboradores).forEach(key => delete colaboradores[key]);
                    // Converter array da API para objeto chaveado por matrÃ­cula
                    dataColab.users.forEach(user => {
                        colaboradores[user.matricula] = {
                            nome: user.nome,
                            matricula: user.matricula,
                            turno: user.turno || '1Âº Turno', // Fallback se null
                            dataCadastro: user.criado_em,
                            totalRetiradas: user.total_retiradas || 0,
                            tempoTotalUso: user.tempo_total_uso || 0
                        };
                    });
                }

                // 3. Carregar HistÃ³rico (se a aba estiver ativa ou autenticada)
                if (document.getElementById('historico').classList.contains('active')) {
                    carregarHistoricoDoServidor();
                }

                // Renderizar na tela
                renderizarColetores();

                // Se estiver na aba de colaboradores, renderiza tambÃ©m
                if (document.getElementById('colaboradores').classList.contains('active')) {
                    renderizarColaboradores();
                }

                atualizarInfoSistema();

            } catch (error) {
                console.error('Erro de conexÃ£o com o servidor:', error);
            }
        }

        async function carregarHistoricoDoServidor() {
            try {
                const res = await fetch('/api/sgao/historico');
                const data = await res.json();
                if (data.success) {
                    historico.length = 0;
                    historico.push(...data.historico);
                    if (historicoAutenticado) {
                        renderizarHistorico();
                    }
                }
            } catch (e) {
                console.error('Erro ao carregar histÃ³rico:', e);
            }
        }

        // ========== AÃ‡Ã•ES DO USUÃRIO (AGORA VIA API) ==========

        async function confirmarRetirada() {
            const coletorTexto = document.getElementById('coletor-selecionado').value;
            const matricula = document.getElementById('matricula-retirada').value;
            const alertDiv = document.getElementById('alert-retirada');

            const numeroColetorMatch = coletorTexto.match(/\d+/);
            if (!numeroColetorMatch) return;
            const numeroColetor = parseInt(numeroColetorMatch[0]);

            if (!matricula) {
                alertDiv.innerHTML = '<div class="alert alert-error">Informe a matrÃ­cula!</div>';
                return;
            }

            try {
                const response = await fetch('/api/sgao/retirar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        numero: numeroColetor,
                        matricula: matricula
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">Retirada registrada com sucesso!</div>';
                    iniciarTimerVisual(numeroColetor);
                    setTimeout(() => {
                        fecharModal('modal-retirada');
                        carregarDadosDoServidor(); // Atualiza a tela
                    }, 1000);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        async function confirmarDevolucao() {
            const coletorTexto = document.getElementById('coletor-devolucao').value;
            const alertDiv = document.getElementById('alert-devolucao');

            const numeroColetorMatch = coletorTexto.match(/\d+/);
            if (!numeroColetorMatch) return;
            const numeroColetor = parseInt(numeroColetorMatch[0]);

            try {
                const response = await fetch('/api/sgao/devolver', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ numero: numeroColetor })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = `<div class="alert alert-success">Devolvido! Tempo: ${data.tempo_uso}</div>`;
                    if (timers[numeroColetor]) {
                        clearInterval(timers[numeroColetor].interval);
                        delete timers[numeroColetor];
                    }
                    setTimeout(() => {
                        fecharModal('modal-devolucao');
                        carregarDadosDoServidor();
                    }, 1500);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        async function enviarParaManutencao() {
            const coletorTexto = document.getElementById('coletor-manutencao').value;
            const motivo = document.getElementById('motivo-manutencao').value.trim();
            const alertDiv = document.getElementById('alert-manutencao');

            const numeroColetorMatch = coletorTexto.match(/\d+/);
            if (!numeroColetorMatch) return;
            const numeroColetor = parseInt(numeroColetorMatch[0]);

            try {
                const response = await fetch('/api/sgao/manutencao', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        numero: numeroColetor,
                        motivo: motivo
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">Enviado para manutenÃ§Ã£o!</div>';
                    setTimeout(() => {
                        fecharModal('modal-manutencao');
                        carregarDadosDoServidor();
                    }, 1000);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        async function retirarDeManutencao() {
            const coletorTexto = document.getElementById('coletor-manutencao').value;
            const alertDiv = document.getElementById('alert-manutencao');
            const numeroColetorMatch = coletorTexto.match(/\d+/);
            const numeroColetor = parseInt(numeroColetorMatch[0]);

            try {
                const response = await fetch('/api/sgao/manutencao/retirar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ numero: numeroColetor })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">Coletor disponÃ­vel novamente!</div>';
                    setTimeout(() => {
                        fecharModal('modal-manutencao');
                        carregarDadosDoServidor();
                    }, 1000);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        // ========== CADASTRO DE COLABORADOR NOVO ==========
        async function cadastrarColaborador() {
            const nome = document.getElementById('novo-nome').value.trim();
            const matricula = document.getElementById('nova-matricula').value.trim();
            const turno = document.getElementById('novo-turno').value;
            const alertDiv = document.getElementById('alert-novo-colaborador');

            if (!nome || !matricula || !turno) {
                alertDiv.innerHTML = '<div class="alert alert-error">Preencha todos os campos!</div>';
                return;
            }

            try {
                // Usa a API de usuÃ¡rios existente no app2.py
                const response = await fetch('/api/usuarios/cadastrar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome: nome,
                        matricula: matricula,
                        senha: matricula, // Senha padrÃ£o = matrÃ­cula
                        permissao: 'operador',
                        permissoes: [] // Campo extra esperado pela sua API
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">Colaborador cadastrado!</div>';

                    // Se a API nÃ£o tiver suporte a turno direto na criaÃ§Ã£o, 
                    // aqui seria um bom lugar para um UPDATE extra, mas assumimos que o banco jÃ¡ tem a coluna
                    // conforme o script anterior.

                    setTimeout(() => {
                        fecharModal('modal-novo-colaborador');
                        carregarDadosDoServidor();
                    }, 1500);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        // ========== FUNÃ‡Ã•ES FALTANTES PARA NOVO COLABORADOR ==========

        // 1. FunÃ§Ã£o que o botÃ£o "Novo Colaborador" chama
        function abrirModalNovoColaboradorComSenha() {
            // Limpa o campo de senha antes de abrir
            document.getElementById('senha-novo-colaborador').value = '';
            document.getElementById('alert-senha-colaborador').innerHTML = '';

            // Abre o modal de pedir senha
            abrirModal('modal-senha-colaborador');
        }

        // 2. FunÃ§Ã£o ATUALIZADA que pergunta ao Banco de Dados se a senha estÃ¡ certa
        async function verificarSenhaCadastro() {
            const senhaInput = document.getElementById('senha-novo-colaborador').value;
            const alertDiv = document.getElementById('alert-senha-colaborador');
            const botao = document.querySelector('#modal-senha-colaborador .btn-primary');

            // Feedback visual (opcional: muda texto do botÃ£o enquanto carrega)
            const textoOriginal = botao.innerHTML;
            botao.innerHTML = 'Verificando...';
            botao.disabled = true;

            try {
                // Envia a senha digitada para o Python verificar
                const response = await fetch('/api/sistema/verificar-senha', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ senha: senhaInput })
                });

                const data = await response.json();

                if (data.success) {
                    // Se o Python disse que estÃ¡ certo:
                    fecharModal('modal-senha-colaborador');
                    abrirModal('modal-novo-colaborador');
                    alertDiv.innerHTML = '';
                } else {
                    // Se o Python disse que estÃ¡ errado:
                    alertDiv.innerHTML = '<div class="alert alert-error">Senha incorreta!</div>';
                }
            } catch (error) {
                console.error('Erro:', error);
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o com o servidor.</div>';
            } finally {
                // Restaura o botÃ£o
                botao.innerHTML = textoOriginal;
                botao.disabled = false;
            }
        }

        // ========== UTILITÃRIOS E UI ==========

        function formatarTempoDecorrido(dataInicioStr) {
            if (!dataInicioStr) return '00:00:00';

            // Tenta converter string BR 'dd/mm/yyyy, HH:MM:SS' para Date object
            let inicio;
            if (typeof dataInicioStr === 'string' && dataInicioStr.includes('/')) {
                const [dataPart, horaPart] = dataInicioStr.split(', ');
                const [dia, mes, ano] = dataPart.split('/');
                inicio = new Date(`${ano}-${mes}-${dia}T${horaPart}`);
            } else {
                inicio = new Date(dataInicioStr);
            }

            if (isNaN(inicio.getTime())) return '00:00:00';

            const diff = new Date() - inicio;
            const horas = Math.floor(diff / (1000 * 60 * 60));
            const minutos = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const segundos = Math.floor((diff % (1000 * 60)) / 1000);

            return `${String(horas).padStart(2, '0')}:${String(minutos).padStart(2, '0')}:${String(segundos).padStart(2, '0')}`;
        }

        // Timer Visual (apenas para atualizar o relÃ³gio na tela, sem lÃ³gica de negÃ³cio)
        function iniciarTimerVisual(numeroColetor) {
            if (timers[numeroColetor]) clearInterval(timers[numeroColetor].interval);

            timers[numeroColetor] = {
                interval: setInterval(() => {
                    // Encontrar o card e atualizar o texto
                    const card = Array.from(document.querySelectorAll('.collector-card h4')).find(el => el.textContent.includes(`Coletor ${String(numeroColetor).padStart(2, '0')}`));
                    if (card) {
                        const cardParent = card.parentElement;
                        const timeSpan = cardParent.querySelector('span[style*="color: #3498db"]');
                        if (timeSpan && coletores[numeroColetor]) {
                            timeSpan.textContent = formatarTempoDecorrido(coletores[numeroColetor].dataRetirada);
                        }
                    }

                    // Se o modal de devoluÃ§Ã£o estiver aberto para este coletor
                    const modalInput = document.getElementById('coletor-devolucao');
                    if (modalInput && modalInput.value.includes(String(numeroColetor).padStart(2, '0'))) {
                        if (coletores[numeroColetor]) {
                            document.getElementById('tempo-uso-display').textContent = formatarTempoDecorrido(coletores[numeroColetor].dataRetirada);
                        }
                    }
                }, 1000)
            };
        }

        // RenderizaÃ§Ã£o da Grade de Coletores
        function renderizarColetores() {
            const grid = document.getElementById('collectors-grid');
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            grid.innerHTML = '';

            const coletoresFiltrados = Object.values(coletores).filter(coletor => {
                const matchSearch = coletor.numero.toString().includes(searchTerm);
                const matchFilter = filtroAtual === 'todos' || coletor.status === filtroAtual;
                return matchSearch && matchFilter;
            });

            coletoresFiltrados.forEach(coletor => {
                const card = document.createElement('div');
                card.className = `collector-card ${coletor.status}`;
                card.onclick = () => abrirModalParaColetor(coletor);

                let infoExtra = '';
                if (coletor.status === 'retirado') {
                    const tempoDecorrido = formatarTempoDecorrido(coletor.dataRetirada);
                    infoExtra = `
                    <div class="collector-info">
                        <p><strong>Colaborador:</strong> ${coletor.colaborador || 'Desc.'}</p>
                        <p><strong>MatrÃ­cula:</strong> ${coletor.matricula || '-'}</p>
                        <p><strong>Turno:</strong> ${coletor.turno || '-'}</p>
                        <p><strong>Retirado em:</strong> ${coletor.dataRetirada || ''}</p>
                        <p><strong>â±ï¸ Tempo de Uso:</strong> <span style="color: #3498db; font-weight: 700;">${tempoDecorrido}</span></p>
                    </div>
                `;
                } else if (coletor.status === 'manutencao') {
                    infoExtra = `
                    <div class="collector-info">
                        <p><strong>ðŸ”§ Em ManutenÃ§Ã£o</strong></p>
                        <p><strong>Desde:</strong> ${coletor.dataManutencao || '-'}</p>
                        <p><strong>Motivo:</strong> ${coletor.motivoManutencao || 'NÃ£o especificado'}</p>
                    </div>
                `;
                } else {
                    infoExtra = `
                    <div style="font-size: 11px; color: #999; margin-top: 10px; text-align: center;">
                        Clique para retirar<br>
                        <kbd style="background: #e0e0e0; padding: 2px 6px; border-radius: 3px;">Ctrl+Click</kbd> para manutenÃ§Ã£o
                    </div>
                `;
                }

                let statusText = coletor.status === 'disponivel' ? 'DisponÃ­vel' :
                    coletor.status === 'retirado' ? 'Em Uso' : 'Em ManutenÃ§Ã£o';

                card.innerHTML = `
                <h4>Coletor ${String(coletor.numero).padStart(2, '0')}</h4>
                <div class="status-indicator status-${coletor.status}">
                    ${statusText}
                </div>
                ${infoExtra}
            `;
                grid.appendChild(card);
            });

            atualizarEstatisticas();
        }

        // Busca de colaborador (Autocomplete no Modal)
        async function buscarColaboradorPorMatricula(matricula) {
            const nomeDisplay = document.getElementById('nome-colaborador-display');
            const turnoDisplay = document.getElementById('turno-display');

            if (matricula.length >= 3) {
                // Primeiro tenta buscar no cache local
                if (colaboradores[matricula]) {
                    const colab = colaboradores[matricula];
                    nomeDisplay.value = colab.nome;
                    turnoDisplay.value = colab.turno;
                    colaboradorSelecionado = colab;
                    document.getElementById('matricula-retirada').style.borderColor = '#00C851';
                } else {
                    // Se nÃ£o achar, tenta buscar na API (caso tenha sido cadastrado por outro PC recentemente)
                    try {
                        const res = await fetch(`/api/sgao/colaborador/${matricula}`);
                        const data = await res.json();

                        if (data.success && data.encontrado) {
                            nomeDisplay.value = data.nome;
                            turnoDisplay.value = data.turno;
                            colaboradorSelecionado = { nome: data.nome, matricula: matricula, turno: data.turno };
                            document.getElementById('matricula-retirada').style.borderColor = '#00C851';
                        } else {
                            nomeDisplay.value = '';
                            turnoDisplay.value = '';
                            colaboradorSelecionado = null;
                            document.getElementById('matricula-retirada').style.borderColor = '#E0E0E0';
                        }
                    } catch (e) {
                        console.error(e);
                    }
                }
            }
        }

        // FunÃ§Ãµes de UI padrÃ£o
        function atualizarEstatisticas() {
            const total = Object.keys(coletores).length;
            const disponiveis = Object.values(coletores).filter(c => c.status === 'disponivel').length;
            const retirados = Object.values(coletores).filter(c => c.status === 'retirado').length;
            const manutencao = Object.values(coletores).filter(c => c.status === 'manutencao').length;

            document.getElementById('total-coletores').textContent = total;
            document.getElementById('coletores-disponiveis').textContent = disponiveis;
            document.getElementById('coletores-retirados').textContent = retirados;
            document.getElementById('coletores-manutencao').textContent = manutencao;
        }

        function abrirModalParaColetor(coletor) {
            if (coletor.status === 'disponivel') {
                if (event && event.ctrlKey) {
                    abrirModalManutencao(coletor, false);
                } else {
                    document.getElementById('coletor-selecionado').value = `Coletor ${String(coletor.numero).padStart(2, '0')}`;
                    document.getElementById('matricula-retirada').value = '';
                    document.getElementById('nome-colaborador-display').value = '';
                    document.getElementById('turno-display').value = '';
                    colaboradorSelecionado = null;
                    abrirModal('modal-retirada');
                }
            } else if (coletor.status === 'retirado') {
                document.getElementById('coletor-devolucao').value = `Coletor ${String(coletor.numero).padStart(2, '0')}`;
                document.getElementById('info-colaborador').innerHTML = `
                <h4 style="margin-bottom: 10px; color: #2C3E50;">InformaÃ§Ãµes do Colaborador</h4>
                <p><strong>Nome:</strong> ${coletor.colaborador}</p>
                <p><strong>MatrÃ­cula:</strong> ${coletor.matricula}</p>
                <p><strong>Turno:</strong> ${coletor.turno}</p>
                <p><strong>Retirado em:</strong> ${coletor.dataRetirada}</p>
            `;
                document.getElementById('tempo-uso-display').textContent = formatarTempoDecorrido(coletor.dataRetirada);
                abrirModal('modal-devolucao');
            } else if (coletor.status === 'manutencao') {
                abrirModalManutencao(coletor, true);
            }
        }

        function abrirModalManutencao(coletor, emManutencao) {
            document.getElementById('coletor-manutencao').value = `Coletor ${String(coletor.numero).padStart(2, '0')}`;
            if (emManutencao) {
                document.getElementById('info-manutencao').innerHTML = `
                <p><strong>ðŸ”§ Status:</strong> Em ManutenÃ§Ã£o</p>
                <p><strong>Desde:</strong> ${coletor.dataManutencao}</p>
                <p><strong>Motivo:</strong> ${coletor.motivoManutencao || 'NÃ£o especificado'}</p>
            `;
                document.getElementById('motivo-group').style.display = 'none';
                document.getElementById('btn-enviar-manutencao').style.display = 'none';
                document.getElementById('btn-retirar-manutencao').style.display = 'inline-block';
            } else {
                document.getElementById('info-manutencao').innerHTML = `<p>Este coletor serÃ¡ marcado como "Em ManutenÃ§Ã£o".</p>`;
                document.getElementById('motivo-group').style.display = 'block';
                document.getElementById('motivo-manutencao').value = '';
                document.getElementById('btn-enviar-manutencao').style.display = 'inline-block';
                document.getElementById('btn-retirar-manutencao').style.display = 'none';
            }
            abrirModal('modal-manutencao');
        }

        function renderizarColaboradores() {
            const grid = document.getElementById('colaboradores-grid');
            const searchTerm = document.getElementById('search-colaboradores').value.toLowerCase();
            grid.innerHTML = '';

            const colaboradoresFiltrados = Object.values(colaboradores).filter(colaborador => {
                return colaborador.nome.toLowerCase().includes(searchTerm) ||
                    colaborador.matricula.toLowerCase().includes(searchTerm);
            });

            colaboradoresFiltrados.forEach(colaborador => {
                const card = document.createElement('div');
                card.className = 'colaborador-card';
                card.onclick = () => editarColaborador(colaborador.matricula);

                const turnoClass = colaborador.turno === '1Âº Turno' ? 'turno-1' : 'turno-2';

                // Verifica uso atual
                const coletorAtivo = Object.values(coletores).find(c =>
                    c.status === 'retirado' && c.matricula === colaborador.matricula
                );

                card.innerHTML = `
                <h4>${colaborador.nome} ${coletorAtivo ? '<span class="active-timer">EM USO</span>' : ''}</h4>
                <div class="colaborador-info">
                    <p><strong>MatrÃ­cula:</strong> ${colaborador.matricula}</p>
                    <p><strong>Turno:</strong> <span class="turno-badge ${turnoClass}">${colaborador.turno}</span></p>
                    <p><strong>Total Retiradas:</strong> ${colaborador.totalRetiradas}</p>
                    <p><strong>Cadastrado em:</strong> ${colaborador.dataCadastro}</p>
                    ${coletorAtivo ? `<p style="color:#d32f2f"><strong>Em posse do Coletor ${String(coletorAtivo.numero).padStart(2, '0')}</strong></p>` : ''}
                </div>
            `;
                grid.appendChild(card);
            });

            // Atualizar stats colaboradores
            document.getElementById('total-colaboradores').textContent = Object.keys(colaboradores).length;
            document.getElementById('colaboradores-turno1').textContent = Object.values(colaboradores).filter(c => c.turno === '1Âº Turno').length;
            document.getElementById('colaboradores-turno2').textContent = Object.values(colaboradores).filter(c => c.turno === '2Âº Turno').length;
        }

        function showTab(tabName) {
            if (tabName === 'backup' || tabName === 'relatorios' || tabName === 'inventario') {
                solicitarSenha(tabName);
                return;
            }
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Ativar aba
            const content = document.getElementById(tabName);
            if (content) content.classList.add('active');

            // Ativar botÃ£o
            const btns = document.querySelectorAll('.tab');
            btns.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(tabName === 'status' ? 'geral' : tabName)) {
                    btn.classList.add('active');
                }
            });

            if (tabName === 'status') renderizarColetores();
            if (tabName === 'colaboradores') renderizarColaboradores();
            if (tabName === 'historico' && historicoAutenticado) carregarHistoricoDoServidor();
        }

        function atualizarInfoSistema() {
            if (!document.getElementById('info-sistema')) return;
            const totalColetores = Object.keys(coletores).length;
            const totalColaboradores = Object.keys(colaboradores).length;
            const coletoresRetirados = Object.values(coletores).filter(c => c.status === 'retirado').length;

            document.getElementById('info-sistema').innerHTML = `
            <div class="info-item"><span class="info-label">Status ConexÃ£o:</span> <span class="info-value" style="color:green">ðŸŸ¢ Online (Banco de Dados)</span></div>
            <div class="info-item"><span class="info-label">Total Coletores:</span> <span class="info-value">${totalColetores}</span></div>
            <div class="info-item"><span class="info-label">Em Uso:</span> <span class="info-value">${coletoresRetirados}</span></div>
            <div class="info-item"><span class="info-label">Colaboradores:</span> <span class="info-value">${totalColaboradores}</span></div>
        `;
        }

        // ========== MODAIS & UTILITÃRIOS ==========
        function abrirModal(id) { document.getElementById(id).classList.add('active'); }
        function fecharModal(id) { document.getElementById(id).classList.remove('active'); limparFormularios(); }
        function limparFormularios() {
            document.querySelectorAll('input').forEach(i => {
                if (!i.readOnly && i.id !== 'search-input') i.value = '';
            });
            document.querySelectorAll('[id^="alert-"]').forEach(d => d.innerHTML = '');
        }
        function filtrarColetores() { renderizarColetores(); }
        function filtrarStatus(status) {
            filtroAtual = status;
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            renderizarColetores();
        }
        function filtrarColaboradores() { renderizarColaboradores(); }

        // FunÃ§Ãµes de Senha/SeguranÃ§a (mantidas do original, mas sem salvar no localstorage)
        function solicitarSenha(acao) {
            // ImplementaÃ§Ã£o simplificada para o exemplo
            const senha = prompt("Digite a senha de acesso (Acesso@2025):");
            if (senha === 'Acesso@2025') {
                if (acao === 'relatorios') window.open('index_relatorio.html', '_blank');
                if (acao === 'inventario') window.open('index_inventario.html', '_blank');
                if (acao === 'backup') {
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById('backup').classList.add('active');
                }
            } else {
                alert("Senha incorreta!");
            }
        }

        // InicializaÃ§Ã£o
        document.addEventListener('DOMContentLoaded', () => {
            carregarDadosDoServidor();

            // POLLING: Atualizar dados a cada 2 segundos para manter sincronia entre PC e Celular
            setInterval(carregarDadosDoServidor, 2000);
        });


        // ========== GESTÃƒO DE COLETORES ADMIN (API) ==========

        async function adicionarNovoColetorAdmin() {
            const numero = parseInt(document.getElementById('admin-novo-numero').value);
            const status = document.getElementById('admin-novo-status').value;
            const observacoes = document.getElementById('admin-novo-observacoes').value.trim();
            const alertDiv = document.getElementById('alert-novo-coletor-admin');

            if (!numero || !status) {
                alertDiv.innerHTML = '<div class="alert alert-error">Preencha os campos obrigatÃ³rios!</div>';
                return;
            }

            try {
                const response = await fetch('/api/sgao/coletores/adicionar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        numero: numero,
                        status: status,
                        observacoes: observacoes
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">âœ… Coletor adicionado!</div>';
                    setTimeout(() => {
                        fecharModal('modal-novo-coletor-admin');
                        carregarDadosDoServidor(); // Atualiza a tela
                        renderizarAdministracao(); // Atualiza painel admin
                    }, 1500);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">âŒ ${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        async function salvarEdicaoColetorAdmin() {
            const numero = parseInt(document.getElementById('admin-edit-numero').value);
            const novoStatus = document.getElementById('admin-edit-status').value;
            const novasObservacoes = document.getElementById('admin-edit-observacoes').value.trim();
            const alertDiv = document.getElementById('alert-editar-coletor-admin');

            try {
                const response = await fetch('/api/sgao/coletores/editar', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        numero: numero,
                        status: novoStatus,
                        observacoes: novasObservacoes
                    })
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">âœ… AlteraÃ§Ãµes salvas!</div>';
                    setTimeout(() => {
                        fecharModal('modal-editar-coletor-admin');
                        carregarDadosDoServidor();
                        renderizarAdministracao();
                    }, 1500);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">âŒ ${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

        async function confirmarRemocaoColetorAdmin() {
            const numero = parseInt(document.getElementById('admin-remover-coletor').value);
            const alertDiv = document.getElementById('alert-remover-coletor-admin');

            if (!numero) {
                alertDiv.innerHTML = '<div class="alert alert-error">Selecione um coletor!</div>';
                return;
            }

            if (!confirm(`Tem certeza que deseja EXCLUIR o Coletor ${numero} permanentemente do banco de dados?`)) {
                return;
            }

            try {
                const response = await fetch(`/api/sgao/coletores/excluir/${numero}`, {
                    method: 'DELETE'
                });

                const data = await response.json();

                if (data.success) {
                    alertDiv.innerHTML = '<div class="alert alert-success">âœ… Coletor excluÃ­do!</div>';
                    setTimeout(() => {
                        fecharModal('modal-remover-coletor-admin');
                        carregarDadosDoServidor();
                        renderizarAdministracao();
                    }, 1500);
                } else {
                    alertDiv.innerHTML = `<div class="alert alert-error">âŒ ${data.message}</div>`;
                }
            } catch (error) {
                alertDiv.innerHTML = '<div class="alert alert-error">Erro de conexÃ£o!</div>';
            }
        }

    </script>


    <style>
        /* ========== ESTILOS PARA PWA ========== */

        /* Ajustes quando executa como PWA */
        .pwa-mode {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Esconder elementos desnecessÃ¡rios no modo PWA */
        .pwa-mode .browser-only {
            display: none !important;
        }

        /* Mostrar apenas no modo navegador */
        .browser-mode .pwa-only {
            display: none !important;
        }

        /* Splash screen personalizado (apenas para PWAs mais avanÃ§adas) */
        @media (display-mode: standalone) {
            .container {
                margin-top: 0;
                border-radius: 0;
            }

            .header {
                padding-top: max(40px, env(safe-area-inset-top) + 20px);
            }
        }

        /* Loading screen para instalaÃ§Ã£o */
        .pwa-installing {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #E31E24, #C11119);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'Inter', sans-serif;
        }

        .pwa-installing .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .pwa-installing h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .pwa-installing p {
            opacity: 0.9;
            text-align: center;
            max-width: 300px;
        }
    </style>

</body>

</html>